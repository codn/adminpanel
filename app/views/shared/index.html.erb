<% provide(:page_title, @model.display_name.pluralize(I18n.default_locale)) -%>
<div class="row-fluid">
  <%= render 'shared/new_resource_button' %>
</div>
<div class="row-fluid">
  <div class="widget widget-padding span12">
    <div class="widget-header">
      <%= content_tag(:i, nil, class: "fa fa-#{@model.icon}") %>
      <h5>
        <%= @model.display_name.pluralize(I18n.default_locale) %>
      </h5>
    </div>
    <div class="widget-body">
      <div class="dataTables_wrapper form-inline">
        <table id="information-table" class="table table-striped table-bordered dataTable">
          <thead><!-- model attributes -->
            <tr>
              <% @model.display_attributes('index').each do |fields| %>
                <% fields.each do |attribute, properties| %>
                  <th><%= properties['label'] %></th>
                <% end %>
              <% end %>
              <th><%= I18n.t('actions') %></th>
            </tr>
          </thead><!-- Ends model attributes -->
          <% if @collection != [] %>
            <% last_update = @collection.max_by(&:updated_at).updated_at %>
          <% end %>
          <% cache ["#{@model.name}-collection", last_update], skip_digest: true do %>
            <tbody>
              <% @collection.each do |member| %>
                <% cache ["#{member.class}-member", member] do %>
                  <tr>
                    <% @model.display_attributes('index').each do |fields| %>
                      <% fields.each do |attribute, properties| %>
                        <td>
                          <%= field_value(properties, attribute, member) %>
                        </td>
                      <% end %>
                    <% end %>
                    <td>
                      <%= render 'shared/show_icon_button',    resource: member %>

                      <%= render 'shared/edit_icon_button',    resource: member %>

                      <%= render 'shared/delete_icon_button',  resource: member %>

                      <%= render 'shared/fb_icon_button',      resource: member %>

                      <%= render 'shared/twitter_icon_button', resource: member %>
                    </td>
                  </tr>
                <% end %> <!-- end member cache -->
              <% end %> <!-- end loop -->
            </tbody>
          <% end %><!-- end collection cache -->
        </table>
      </div>
    </div>
  </div>
</div>
